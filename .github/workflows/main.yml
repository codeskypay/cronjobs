name: sirtheprogrammer

on:
  schedule:
    - cron: "0 7,9,12,13,14 * * *"
  workflow_dispatch:

permissions:
  contents: write

jobs:
  auto_commit:
    runs-on: ubuntu-latest
    env:
      TZ: Africa/Dar_es_Salaam
      CRONITOR_MONITOR: abcd1234

    steps:
      - name: ğŸ”” Cronitor Start
        run: |
          curl -fsS "https://cronitor.link/p/${CRONITOR_MONITOR}?state=run" || true

      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4

      - name: ğŸ•’ Update file
        run: |
          date '+%Y-%m-%d %H:%M:%S %Z' > LAST_UPDATED

      - name: ğŸ”§ Git config
        run: |
          git config user.name "auto-bot"
          git config user.email "auto-bot@users.noreply.github.com"

      - name: ğŸ² Commit changes
        run: |
          messages=("ğŸ¤– auto sync" "ğŸš€ keep alive" "ğŸ‘» ghost commit" "ğŸ legendary")
          n=$((RANDOM % 5 + 2))

          for ((i=1;i<=n;i++)); do
            echo "update $i $(date)" > file_$i.txt
            git add -A
            git commit -m "${messages[RANDOM % ${#messages[@]}]}" || true
            sleep $((RANDOM % 4 + 1))
          done

      - name: ğŸš€ Push
        run: git push origin main

      - name: âœ… Cronitor Success
        if: success()
        run: |
          curl -fsS "https://cronitor.link/p/${CRONITOR_MONITOR}?state=complete" || true

      - name: âŒ Cronitor Fail
        if: failure()
        run: |
          curl -fsS "https://cronitor.link/p/${CRONITOR_MONITOR}?state=fail" || true
